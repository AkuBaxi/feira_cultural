<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>TESTE IA</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            font-family: Arial, sans-serif;
        }

        #start-screen {
            position: fixed;
            width: 100vw;
            height: 100vh;
            background-color: rgba(0, 0, 0, 0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        #start-title {
            color: white;
            font-size: 48px;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        #start-button {
            padding: 15px 40px;
            font-size: 24px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        #start-button:hover {
            transform: scale(1.1);
            background-color: #45a049;
        }

        #tutorial-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 4;
            display: none;
        }

        #tutorial-box {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0.9);
            padding: 20px;
            border-radius: 10px;
            color: white;
            z-index: 5;
            text-align: center;
            display: none;
        }

        #tutorial-text {
            font-size: 18px;
            margin-bottom: 20px;
        }

        #tutorial-next {
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        #narrator-container {
            position: fixed;
            top: 20px;
            left: 20px;
            width: 300px;
            background-color: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border-radius: 10px;
            color: white;
            z-index: 5;
            display: none;
        }

        #narrator-avatar {
            width: 50px;
            height: 50px;
            background: url('img/bonecoTeste.png') no-repeat center center;
            background-size: contain;
            margin-bottom: 10px;
        }

        #narrator-text {
            font-size: 14px;
            line-height: 1.4;
        }

        #game-container {
            width: 2400px;
            height: 100vh;
            position: relative;
            overflow: hidden;
            background: url('img/fundo.jpg') repeat-x;  
            background-size: auto 100%;
        }

        #viewport {
            width: 100vw;
            height: 100vh;
            position: relative;
            overflow: hidden;
        }

        #game-world {
            width: 2400px;
            height: 100vh;
            position: absolute;
            left: 0;
            transition: left 0.3s ease;
        }

        #player {
            width: 50px;
            height: 50px;
            background: url('img/bonecoTeste02.png') no-repeat center center;
            background-size: contain;
            position: absolute;
            bottom: 100px;
            left: 100px;
            z-index: 2;
            transition: transform 0.1s;
        }

        .flip {
            transform: scaleX(-1);
        }

        .npc {
            width: 90px;
            height: 90px;
            position: absolute;
            bottom: 100px;
            z-index: 1;
            background-repeat: no-repeat;
            background-position: center;
            background-size: contain;
            transition: transform 0.3s;
        }

        .structure {
            position: absolute;
            bottom: 100px;
            z-index: 1;
            transition: transform 0.3s;
        }

        #ground {
            width: 100%;
            height: 100px;
            background-color: rgba(78, 250, 10, 0.7);
            position: absolute;
            bottom: 0;
        }

        #dialog-box {
            width: 80vw;
            max-width: 800px;
            background-color: rgba(0,0,0,0.9);
            color: white;
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: none;
            padding: 20px;
            border-radius: 10px;
            z-index: 3;
            font-size: 18px;
        }

        #reputation-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 4;
            background-color: rgba(0,0,0,0.7);
            padding: 10px;
            border-radius: 5px;
            color: white;
        }

        #reputation-bar {
            width: 200px;
            height: 20px;
            background-color: #4287f5;
            margin-top: 5px;
            border-radius: 10px;
            overflow: hidden;
        }

        #reputation-indicator {
            width: 50%;
            height: 100%;
            background-color: white;
            transition: width 0.3s ease;
        }

        .choice-button {
            margin: 8px;
            padding: 10px 20px;
            font-size: 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .choice-button:hover {
            background-color: #45a049;
            transform: scale(1.05);
        }

        #controls-hint {
            position: fixed;
            top: 20px;
            left: 20px;
            background-color: rgba(0,0,0,0.7);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-size: 14px;
            display: none;
        }
    </style>
</head>
<body>
    <div id="start-screen">
        <h1 id="start-title">TESTE IA</h1>
        <button id="start-button">Iniciar Jornada</button>
    </div>

    <div id="tutorial-overlay"></div>
    <div id="tutorial-box">
        <p id="tutorial-text"></p>
        <button id="tutorial-next">Próximo</button>
    </div>

    <div id="narrator-container">
        <div id="narrator-avatar"></div>
        <div id="narrator-text"></div>
    </div>

    <div id="viewport">
        <div id="controls-hint">
            Controles:<br>
            A/← - Mover para esquerda<br>
            D/→ - Mover para direita<br>
            E/Enter - Interagir
        </div>
        <div id="reputation-container">
            <div>Reputação</div>
            <div id="reputation-bar">
                <div id="reputation-indicator"></div>
            </div>
        </div>
       
        <div id="game-container">
            <div id="game-world">
                <div id="ground"></div>
                <div id="player"></div>
            </div>
        </div>
        <div id="dialog-box">
            <p id="dialog-text"></p>
            <div id="choice-container"></div>
        </div>
    </div>

    <script>
        const player = document.getElementById('player');
        const dialogBox = document.getElementById('dialog-box');
        const dialogText = document.getElementById('dialog-text');
        const choiceContainer = document.getElementById('choice-container');
        const reputationIndicator = document.getElementById('reputation-indicator');
        const gameWorld = document.getElementById('game-world');
        const viewport = document.getElementById('viewport');
        const gameContainer = document.getElementById('game-container');
        const controlsHint = document.getElementById('controls-hint');
        
        const startScreen = document.getElementById('start-screen');
        const startButton = document.getElementById('start-button');
        const tutorialOverlay = document.getElementById('tutorial-overlay');
        const tutorialBox = document.getElementById('tutorial-box');
        const tutorialText = document.getElementById('tutorial-text');
        const tutorialNext = document.getElementById('tutorial-next');
        const narratorContainer = document.getElementById('narrator-container');
        const narratorText = document.getElementById('narrator-text');

        let playerX = 100;
        let worldX = 0;
        let reputation = 0;
        let isDialogActive = false;
        let currentNPC = null;
        let playerSpeed = 5;
        let gameStarted = false;

        let isJumping = false;
        let isGrounded = true;
        let jumpHeight = 100;
        const maxJumpHeight = 300;
        const jumpSpeed = 20;
        const fallSpeed = 15;

        const npcs = [
            {
                id: 'merchant',
                x: 300,
                type: 'Mercador',
                sprite: 'img/bonecoNPCTeste.png'
            },
            {
                id: 'quest_giver',
                x: 800,
                type: 'Aldeão',
                sprite: 'img/bonecoNPCTeste2.png'
            },
            {
                id: 'wizard',
                x: 1500,
                type: 'Mago',
                sprite: 'img/bonecoNPCTeste.png'
            }
        ];

        const structures = [
            { x: 500, width: 100, height: 150, color: 'rgba(139, 69, 19, 0.7)', type: 'house' },
            { x: 1200, width: 150, height: 200, color: 'rgba(74, 74, 74, 0.7)', type: 'tower' },
            { x: 2000, width: 120, height: 180, color: 'rgba(139, 69, 19, 0.7)', type: 'inn' }
        ];

        function createWorldElements() {
            npcs.forEach(npc => {
                const npcElement = document.createElement('div');
                npcElement.className = 'npc';
                npcElement.style.left = `${npc.x}px`;
                npcElement.style.backgroundImage = `url('${npc.sprite}')`;
                npcElement.id = npc.id;
                gameWorld.appendChild(npcElement);
            });

            structures.forEach(structure => {
                const structureElement = document.createElement('div');
                structureElement.className = 'structure';
                structureElement.style.backgroundColor = structure.color;
                structureElement.style.width = `${structure.width}px`;
                structureElement.style.height = `${structure.height}px`;
                structureElement.style.left = `${structure.x}px`;
                gameWorld.appendChild(structureElement);
            });
        }

        async function getNPCDialog(npcType) {
            const dialogs = {
                'Mercador': {
                    text: "Olá, viajante! Precisa de alguma mercadoria?",
                    choices: [
                        { 
                            text: "Sim, quero comprar algo", 
                            effect: 1 
                        },
                        { 
                            text: "Não, obrigado", 
                            effect: -1 
                        }
                    ]
                },
                'Aldeão': {
                    text: "Bem-vindo à nossa aldeia. Tem alguma notícia para compartilhar?",
                    choices: [
                        { 
                            text: "Contar uma história interessante", 
                            effect: 2 
                        },
                        { 
                            text: "Ignorar o aldeão", 
                            effect: -2 
                        }
                    ]
                },
                'Mago': {
                    text: "Ah, um viajante se aproxima. Qual é o seu propósito aqui?",
                    choices: [
                        { 
                            text: "Buscar conhecimento", 
                            effect: 3 
                        },
                        { 
                            text: "Desafiar o mago", 
                            effect: -3 
                        }
                    ]
                }
            };

            return dialogs[npcType] || {
                text: "Olá, não tenho nada para dizer no momento.",
                choices: [
                    { 
                        text: "Ok", 
                        effect: 0 
                    }
                ]
            };
        }

        let currentTutorialStep = 0;
        const tutorialSteps = [
            "Bem-vindo ao nosso RPG Interativo! Vamos aprender os controles básicos.",
            "Use as teclas A/← para mover para esquerda e D/→ para mover para direita.",
            "Pressione Espaço para pular.",
            "Pressione E ou Enter próximo a um NPC para interagir com ele.",
            "Suas escolhas durante os diálogos afetarão sua reputação no jogo.",
            "Agora você está pronto para começar sua aventura! Boa sorte!"
        ];

        const narrations = [
            "Em nossa jornada, cada escolha que fazemos molda não apenas nossa história, mas também o mundo ao nosso redor.",
            "Como uma IA, aprendi que a ética não está apenas nas grandes decisões, mas em cada pequena interação.",
            "Observe como suas escolhas afetam sua reputação. Seja gentil ou hostil, cada ação tem uma consequência.",
            "O verdadeiro poder não está na força, mas na sabedoria de nossas escolhas."
        ];

        let currentNarration = 0;

        startButton.addEventListener('click', () => {
            startScreen.style.display = 'none';
            showTutorial();
            startNarration();
        });

        function showTutorial() {
            tutorialOverlay.style.display = 'block';
            tutorialBox.style.display = 'block';
            updateTutorial();
        }

        function updateTutorial() {
            if (currentTutorialStep < tutorialSteps.length) {
                tutorialText.textContent = tutorialSteps</antArtifact>